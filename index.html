<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="/removeRails.css">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.2/angular.js"></script>
    <script type="text/javascript" src="/removeRails.js"></script>
  </head>
  <body ng-app="removeRails">
    <div class="container" ng-controller="removeRailsController as ctrl">
      <h1>Survey Results</h1>
      <div class="indexPresentationContainer">
        <script type="text/javascript">document.write('<div class="spinner" ng-if="ctrl.loading() && ctrl.surveyIndices() == null"></div>');</script>
        <div class="indexPresentation" ng-show="ctrl.surveyIndices()">
          <p>{{ ctrl.surveyIndices().length + ' Surveys found, click to view.' }}</p>
          <ul class="surveyIndex">
            <li ng-repeat="index in ctrl.surveyIndices()">
              <button class="surveyButton" ng-click="ctrl.loadSurvey(index.url)">{{ index.name }}</button>
            </li>
          </ul>
        </div> <!-- /indexPresentation -->
      </div> <!-- /indexPresentationContainer -->
      <script type="text/javascript">document.write('<div class="spinner" ng-if="ctrl.loading() && ctrl.getSurveyData() == null && ctrl.surveyIndices() != null"></div>');</script>
      <div id="dataPresentationContainer" ng-if="ctrl.getSurveyData() != null">
        <div class="surveyMeta">
          <span>Survey: </span><span ng-bind="ctrl.getSurveyData().name"></span>
          <span>Participants: </span><span ng-bind="ctrl.getSurveyData().participant_count"></span>
          <span>Respondents: </span><span ng-bind="ctrl.getSurveyData().submitted_response_count"></span>
          <span>Response rate: </span><span>{{ ((ctrl.getSurveyData().submitted_response_count / ctrl.getSurveyData().participant_count) * 100 | number: 2) + '%' }}</span>
        </div> <!-- /surveyMeta -->
        <!-- <marquee> -->
        <div class="surveyVisualContainer">
          <div class="surveyVisual">
            <ul class="themes">
              <li class="theme" ng-repeat="theme in ctrl.getSurveyData().themes">
                <p class="themeName">{{ theme.name }}</p>
                <ul class="questions">
                  <li class="question" ng-repeat="question in theme.questions">
                    <p>{{ question.description }}</p>
                    <div class="graphicContainer {{ question.question_type }}">
                      <div class="barGraphContainer">
                        <ul class="barGraph" ng-if="question.question_type == 'ratingquestion'">
                          <li ng-repeat="value in question.collated_results.totals">
                            <div class="bar" style="height: {{ value.proportional }}px; width: 30px;"><span>{{ value.raw }}</span></div>
                          </li>
                        </ul>
                      </div>
                    </div> <!-- /graphicContainer -->
                    <p>{{ 'Average: ' + (question.collated_results.average | number: 2) }}</p>
                  </li>
                </ul>
              </li>
            </ul>
          </div> <!-- /surveyVisual -->
        </div> <!-- /surveyVisualContainer -->
      </div> <!-- /dataPresentationContainer -->
    <!-- </marquee> -->
    </div> <!-- /ng-controller -->
  </body>
</html>
